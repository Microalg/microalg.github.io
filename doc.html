<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Doc - MicroAlg</title>
        <meta name="description"
              content="Tutoriel en ligne pour MicroAlg." />
        <meta name="keywords" content="microalg, algo, algorithme, algorithmique, lisp, environnement" />
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="web/jquery.min.js"><\/script>')</script>
        <script src="web/showdown.js"></script>
        <script src="web/showup.js"></script>
        <link type="text/css" href="web/showup.css" rel="stylesheet" />
        <script src="emulisp/int.js" type="text/javascript"></script>
        <script src="emulisp/emulisp_core.js" type="text/javascript"></script>
        <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
        <link rel="stylesheet" type="text/css" href="web/style.css" />
        <script type="text/javascript" src="web/ide_injections.js"></script>
        <link rel="stylesheet" type="text/css" href="web/parenedit.css" />
    </head>
    <body class="microalg doc">
        <div class="navbar">
            <a href="./">Accueil</a> :
            <a href="#top">Haut de page</a>
        </div>
        <noscript>
            <div style="color:#CC0000; text-align:center">
            Besoin de JavaScript pour afficher certaines listes.
            </div>
        </noscript>
        <script>EMULISP_CORE.loadLisp("microalg.l");</script>
        <script type="text/markdown">
<!--
<div id="top"></div>

# MicroAlg - Documentation

Aller directement à :

* [Installation](#installation)
* [Pourquoi MicroAlg](#pourquoimicroalg)
* [Limitations](#limitations)
* [Syntaxe](#syntaxe)
* [Liste des symboles prédéfinis](#listedessymbolesprdfinis)
* [Types](#types)
* [Erreurs fréquentes](#erreursfrquentes)
* [Feuille de route](#feuillederoute)
* [Contribuer](#contribuer)
* [Architecture](#architecture)
* [Intégrations](#intgrations)
    * [SciTE](#scite)
    * [Vim](#vim)
    * [Blockly](#blockly)
    * [Sortie graphique](#sortiegraphique) et [Tortue](#tortue) (merci Processing)
* [Remerciements](#remerciements)

## Avertissement

Que vous soyez débutant ou expert en informatique ou même en programmation,
cette page n’est pas idéale pour apprendre à utiliser MicroAlg. Voir plutôt le
[tutoriel officiel](tuto.html).

## Installation

Voir le fichier [INSTALL.md](https://github.com/Microalg/Microalg/blob/latest/INSTALL.md).

## Pourquoi MicroAlg ?

Suite à une formation suivie pour enseigner ISN, j’ai décidé vers le printemps
2012 de me lancer dans un outil pédagogique pour l’algorithmique. Après deux ans
de profonde réflexion puis de maturation en tiroir, le
[dépôt GitHub](https://github.com/Microalg/Microalg), sorte de quartier général
du projet, est créé fin mars 2014. Suivront :

* le [site officiel](http://microalg.info) et
  [son dépôt](https://github.com/Microalg/microalg.github.io),
* le [compte Twitter](https://twitter.com/microalg).

## Limitations

MicroAlg est encore jeune et il manque encore des choses importantes avant
qu’elle ne soit considérée comme complète :

### Messages d’erreur

#### Non traduits

Les messages d’erreurs ne sont pas encore tous très clairs, voire même pas
encore tous en français. J’attends que les instructions `throw` et `catch`
soient implémentées dans EmuLisp.

#### Numéro de ligne

Dans les versions JavaScript (et donc dans le navigateur), le numéro de la ligne
où l’erreur a eu lieu n’est pour l’instant pas connu.

Dans les autres versions, le numéro de ligne donné en cas d’erreur pointe vers
l’expression la plus extérieure, ce qui est insuffisant quand par exemple
l’erreur a eu lieu dans un `Tant_que` assez volumineux.

### Retour de fonction non interruptif

La commande `Retourner` n’interrompt pas la commande en cours. Voir
[ici](tuto.html#script-bug-retourner) une illustration du problème.

Il est tout de même possible de contourner le problème en se débrouillant pour
placer la commande `Retourner` à la toute fin de la commande à définir.

### Nombres

*EN BREF*  
Les nombres sont gérés différemments selon la façon dont vous utilisez
MicroAlg. Par défaut cependant, que ce soit dans le navigateur ou après
installation, MicroAlg travaille avec des
<a href="http://fr.wikipedia.org/wiki/Virgule_flottante" class="wp">nombres
flottants</a>.

*EN DÉTAILS*  
Dans les versions reposant sur JavaScript, c’est-à-dire dans le navigateur mais
aussi hors web grâce à
<a href="https://developer.mozilla.org/fr/docs/Rhino" class="offi">Rhino</a> ou
<a href="http://fr.wikipedia.org/wiki/Node.js" class="wp">NodeJS</a>,
MicroAlg travaille avec des
<a href="http://fr.wikipedia.org/wiki/Virgule_flottante" class="wp">nombres
flottants</a>. C’est plutôt appréciable, sauf que dans les autres versions
(celles reposant sur PicoLisp ou Ersatz), ça ne sera pas possible directement
(voir la documentation officielle de PicoLisp sur les nombres :
[ici](http://www.software-lab.de/doc/ref.html#number) et
[là](http://www.software-lab.de/doc/ref.html#num-io)).

### Saisie utilisateur avec SciTE

Si vous utilisez SciTE sous autre chose que Windows, pas moyen de faire
en sorte que `(Demander)` attende l’utilisateur.

## Syntaxe

### Instructions

* Un *programme* est constitué d’une ou plusieurs *instructions*.
* Une *instruction* est constituée de parenthèses, contenant une *commande* et
  ses *arguments* :  
  `(Commande arg1 arg2 ...)`
* Les séparateurs possibles sont :
    * l’espace,
    * le retour à la ligne,
    * la tabulation (déconseillée).
* C’est absolument universel dans MicroAlg. Même les commentaires sont de cette
  forme :  
  `(!!! "Ceci est un commentaire")`
* Si une *commande* ne prend pas d’*argument*, on écrira simplement :  
  `(Commande)`. C’est assez rare, les seules commandes qui n’ont pas besoin de
  paramètre sont `Demander`, `Initialiser@` et `Millisecondes`.
* Les *instructions* peuvent être imbriquées. En effet, dans une *instruction*,
  un des *arguments* d’une *commande* peut être remplacé par une autre
  *instruction* :  
  `(Commande2 (Commande1 arg1 arg2 ...) arg3 ...)`  
  Dans ce cas, c’est la commande qui est à l’intérieur qui est exécutée en
  premier. Un environnement MicroAlg doit colorer les parenthèses selon leur
  profondeur :
  <span class="paren_1">(</span> <span class="paren_2">(</span> <span class="paren_3">(</span> <span class="paren_4">(</span> <span class="paren_5">(</span> <span class="paren_6">(</span> <span class="paren_0">(</span> <span class="paren_0">)</span> <span class="paren_6">)</span> <span class="paren_5">)</span> <span class="paren_4">)</span> <span class="paren_3">)</span> <span class="paren_2">)</span> <span class="paren_1">)</span>.
* Les symboles (noms de variables ou commandes) ne peuvent pas contenir les
  caractères suivants :  
  `"` `'` `(` `)` `,` `[` `]` `` ` `~` `{` `}`.  
  Le point peut être utilisé dans un symbole, mais pas tout seul.

<div id="trucs-syntaxe"></div>
Quelques « trucs » :

* Si l’indentation est respectée :
    * les parenthèses en début de ligne (ouvrantes ou fermantes) seront toujours rouges ;
    * les parenthèses correspondantes n’étant pas sur la même ligne mais
      alignées verticalement seront de la même couleur.
* On ne trouvera jamais deux parenthèses ouvrantes de suite.

### Symboles

À part les **parenthèses**, les **nombres** (le séparateur est le `.`) et les
**textes** (délimités par des `"`), le langage comporte des symboles. Ils sont
organisés comme ceci :

* symboles
    * commandes
        * prédéfinies
            * flot (`Si`, `Tant_que`…)
            * structures de données (`Liste`…)
            * autres (`Afficher`, `Concatener`…)
        * définies par l’utilisateur
    * mots-clefs
        * intermédiaires (`Alors`, `Sinon`…)
        * autres (`Vrai`, `Faux`, `Rien`…)
    * variables (le reste des symboles), qui le plus souvent :
        * sont définies par l’utilisateur
        * commencent par une minuscule

<div id="variables"></div>

Les variables sont des symboles qui renferment un valeur. Dans un algorithme,
elles servent souvent à stocker une valeur qui va servir plusieurs fois ou
suivre l’évolution d’une quantité.

### Conventions

Le nom d’une commande :

* ne contient pas d’accent ;
* commence par une majuscule ;
* le « tiret du 8 » ou « underscore » (`_`) en sépare les mots ;
* se termine par `?` si la commande retourne un booléen (sauf pour
  `=`, `=/`, `<`, `<=`, `>` et`>=`).

## Liste des symboles prédéfinis

Cette section est générée directement à partir du fichier `microalg.l`, que
vous pouvez trouver [ici](microalg.l).

Aller directement à :

<div id="syms"></div>

## Types

En cours de rédaction.

On trouvera :

* [booléen](#boolen),
* [nombre](#nombre),
* [texte](#texte),
* [liste](#liste),
* [commande](#commande).

### Booléen

Deux valeurs : `Vrai` ou `Faux`.

### Nombre

Les nombres de MicroAlg sont ceux de PicoLisp.

* Les entiers sont arbitrairement grands, positifs ou négatifs.
    * [Documentation PicoLisp](http://software-lab.de/doc/ref.html#number)
      (en anglais)
* Les décimaux sont à <a href="http://fr.wikipedia.org/wiki/Virgule_fixe"
  class="wp">virgule fixe</a>.
    * Le séparateur décimal est `.`.
    * L’échelle est `*Scl`. <!-- TODO: http://pastebin.com/A6tPQNqT -->
    * [Documentation PicoLisp](http://software-lab.de/doc/ref.html#num-io)
      (en anglais)

### Texte

Délimités par des guillemets doubles : `"salut"`.

* [Documentation PicoLisp](http://software-lab.de/doc/ref.html#transient)
  (en anglais)
* [Documentation PicoLisp](http://software-lab.de/doc/ref.html#transient-io)
  (en anglais)

### Liste

En cours de rédaction.

**Attention, les listes ne sont pas disponibles dans la version web !**

### Commande

En cours de rédaction.

## Erreurs fréquentes

Les messages sont classés par ordre alphabétique, sans tenir compte de la
valeur ou de la commande qui est parfois fournie :

* `Afficher` n’a qu’un paramètre, faites plusieurs affichages ou utilisez
  `Concatener`.
    * Vous utilisez peut-être `Concatener`, mais il manque une parenthèse
      fermante. Le reste du programme est vu comme le reste des arguments à
      `Afficher`.
* Commande `Faire` sans mot-clé `Tant_que`.
    * `Tant_que` est peut-être mal orthographié, ou il manque peut-être le « _ »
      ou la majuscule.
    * Le `Faire` correspondant a pu être fermé prématurément.  
      `(Faire (=/ n 1)) <- une parenthèse fermante en trop`
* Commande `Tant_que` sans mot-clé `Faire`.
    * `Faire` est peut-être mal orthographié, n’oubliez pas la majuscule.
    * Le `Tant_que` correspondant a pu être fermé prématurément.  
      `(Tant_que (=/ n 1)) <- une parenthèse fermante en trop`
* Crédit d’itérations épuisé (1 000 par défaut). Vous pouvez recharger votre
  crédit en affectant une valeur à la variable `credits_iterations`.
    * Peut-être que vous gérez mal la condition ou le compteur d’une des
      boucles de votre programme. Sinon, si votre programme a vraiment besoin
      de plus d’itérations, vous pouvez recharger votre crédit en affectant
      une valeur à la variable `credits_iterations`.
* `Entier@` prend 2 paramètres. Vous en donnez X.
* EOF Overrun
    * Il manque une parenthèse fermante quelque part. La ligne indiquée est
      celle de la parenthèse ouvrante isolée.
* X -- Executable or Number expected.
    * Vous avez ouvert deux parenthèses de suite.
    * Il y a une parenthèse en trop devant `X`.
* Il manque le deuxième paramètre : l’indice.
* Impossible d’utiliser la sortie graphique avec `malg-njs` ou `malg-rjs`.
    * Il faut configurer SciTE pour qu’il utilise `malg-j` (voire `malg` si
      vous avez pu l’installer). Cliquer sur **View** puis **Parameters** et
      indiquer par exemple `malg-j`.  Voir [cette section](#horsnavigateur).
* Indice négatif ou nul.
* Indice non entier.
* Indice trop grand.
* `Initialiser` prend 2 paramètres. Vous en donnez X.
* java.lang.ClassCastException: PicoLisp$Symbol cannot be cast to PicoLisp$Number
    * Une commande qui concerne uniquement les nombres (comme `+`, `-`, `*`,
    `/`, `%` ou `**`) a été écrite avec autre chose qu’un nombre en argument
    (peut-être du texte, un booléen, une liste ou `Rien`).
* java.lang.NullPointerException
    * Il y a peut-être dans votre code une commande de la forme `(x)` ou `x`
      est une variable contenant un nombre. Dans ce cas, vous voulez peut-être
      juste écrire la valeur de `x`, car `x` n’est pas une commande.
* java.lang.StackOverflowError
    * Voir la sous-section [récursion](#rcursion).
* X -- La condition n’est pas un booléen.
    * Voir la sous-section [booléens](#boolens).
* La variable n’est pas initialisée.
    * Vous utilisez une variable inconnue de MicroAlg. Vérifier l’orthographe
      de la variable.
* Le premier paramètre de `Entier@` doit être un nombre.
* Le premier paramètre de X doit être un booléen.
    * Voir la sous-section [booléens](#boolens).
* Le second paramètre de `Entier@` doit être un nombre.
* Le second paramètre de X doit être un booléen.
    * Voir la sous-section [booléens](#boolens).
* (V est un W ; X un Y) -- Le type ne correspond pas.
* Mauvais tirage forcé : x n’est pas compris entre min et max.
* Maximum call stack size exceeded.
    * Voir la sous-section [récursion](#rcursion).
* Mot-clef `Alors` manquant.
    * La condition du `Si` correspondant a pu être laissée ouverte.
    * Le `Si` correspondant a pu être fermé prématurément.
* `Non` prend un paramètre booléen.
    * Voir la sous-section [booléens](#boolens).
* X -- Number expected
    * Vous avez sans doute tenté un calcul (`+`, `-`, …) faisant intervenir
      une valeur qui n’est pas du type nombre. C’est souvent le cas si vous
      utilisez la commande `Demander`.  
      Pensez à utiliser la commande `Nombre` pour convertir cette valeur.
* X not found.
    * Voir la sous-section [espaces dans les noms de fichiers](#espacesdanslesnomsdefichiers).
* X -- Read open error
    * Voir la sous-section [espaces dans les noms de fichiers](#espacesdanslesnomsdefichiers).
* Stack overflow
    * Voir la sous-section [récursion](#rcursion).
* too much recursion
    * Voir la sous-section [récursion](#rcursion).
* Un objet vide n’a pas de queue.
* Un objet vide n’a pas de tête.
* X -- undefined
    * Vous tentez d’utiliser la commande `X` mais qui n’existe pas. La
      commande est sans doute mal orthographiée, ou vous utilisez une vieille
      version de MicroAlg.
    * « `Affecter` -- undefined » indique qu’il vous manque un « _ ».
    * « `Tant` -- undefined » indique qu’il vous manque un « _ ».
* Valeur de type X, ne peut initialiser Y qui est de type Z.
* X -- Variable non initialisée.
    * Affectation sur une variable non initialisée.

Si jamais le message que vous avez n’est pas ou pas assez documenté, merci de
le signaler en :

* [postant une « issue » sur Github](https://github.com/Microalg/Microalg/issues/new) ;
* posant une question dans [la section Questions/Réponses](http://qr.microalg.info) ;
* envoyant un <a href="mailto:profgra.org@gmail.com" class="email">email au
  créateur de MicroAlg</a>.

### Booléens

*  Si un comparateur est utilisé pour produire un booléen, penser à le mettre
   en premier car c’est une commande comme les autres. Par exemple `(n > 1)`
   ne fonctionnera pas, il faut écrire `(> n 1)`.

### Récursion

* Il est possible que vos appels récursifs (appel d’une commande depuis sa
  définition) ne trouvent pas de point d’appui. Votre test est-il bon ?  
  Avant que l’ordinateur ne *plante* franchement, un des langages utilisés par
  MicroAlg arrête ce qui lui semble être un travail infini. La limite est
  variable et ne peut que très rarement être modifiée.

### Espaces dans les noms de fichiers

* Le fichier que vous voulez exécuter n’a pas été trouvé. C’est sans doute
  parce que son nom contient des espaces. Pour le confirmer, observez le nom de
  fichier qui précède ce message d’erreur, il s’arrête sans doute au premier
  espace rencontré.

## Feuille de route

Voici les directions que le projet va prendre :

* Finir d’implémenter le jeu d’instructions de base.
    * Il manque la lecture/écriture depuis/dans un fichier.
* Finir de coder les derniers blocs pour
  <a href="https://blockly-demo.appspot.com/static/apps/index.html"
  class="offi">Blockly</a>.

À un niveau moins général, des rapports de bugs ou idées d’amélioration sont
régulièrement [reportées sur Github](https://github.com/Microalg/Microalg/issues?state=open).

## Contribuer

Toutes les bonnes volontés sont les bienvenues pour contribuer à MicroAlg. Il
y aura de la place pour tout le monde. Voici une liste non exhaustive suivant
les compétences techniques au autres du contributeur :

* **aucune compétence** :
    * lire, installer, tester, et rapporter des bugs ou des suggestions ;
    * versions web, Windows, Android, iOS, Mac…
* compétences en **pédagogie** (en maths, en algorithmique, en informatique ou
  même en général) :
    * lire et tester les tutoriels ;
    * critiquer le langage ;
    * critiquer les interfaces ;
    * créer des tutoriels ;
* compétences en **communication**, **marketing**, ou juste un gros réseau :
    * buzzer le projet ;
* compétences en **orthographe**, **expression ecrite** :
    * relire et corriger les fautes, trouver de meilleures formulations ;
    * travailler sur le [tutoriel simple](tuto_simple.html) ;
* compétences **pédagogiques** :
    * retravailler les tutoriels ;
    * écrire d’autres tutoriels, par exemple pour détailler un sujet précis ;
* compétences en **visuels numériques**, **HTML/CSS** :
    * travailler sur l’apparence du site ;
* compétences en **développement** (Java, JavaScript, jQuery, PicoLisp…) :
    * améliorer l’interface web ;
    * applis Android ou iOS, installateurs pour Mac ou PC ;
    * construire de nouvelles interfaces, par exemple avec GeoGebra ;
    * travailler sur le cœur du projet (émettre des messages d’erreur
      compréhensibles et « actionnables » pour l’utilisateur) ;

Pour cela, il y a plusieurs méthodes :

* proposer une « pull request » en éditant directement
  [un fichier sur Github](https://github.com/Microalg/Microalg), ou après avoir
  cloné le dépôt ;
* [poster une « issue » sur Github](https://github.com/Microalg/Microalg/issues/new) ;
* poser une question dans [la section Questions/Réponses](http://qr.microalg.info) ;
* envoyer un <a href="mailto:profgra.org@gmail.com" class="email">email au
  créateur de MicroAlg</a>.

## Architecture

### Diagramme

<img alt="Diagramme d’architecture" src="visuels/archi.svg" />

**Légende**

* MACHINE : l’ordinateur, le smartphone, la tablette, la machine virtuelle…
* JVM : pour <a href="http://fr.wikipedia.org/wiki/Machine_virtuelle_Java"
  class="wp">Java Virtual Machine</a>,
  exécute du byte-code Java
* Rhino : plateforme en Java pur permettant d’interpréter du code JavaScript
  (voir <a href="http://fr.wikipedia.org/wiki/Rhino_%28moteur_JavaScript%29"
  class="wp">l’article Wikipedia</a>)
* NodeJS : plateforme permettant d’interpréter du code JavaScript
  (voir <a href="http://fr.wikipedia.org/wiki/Nodejs"
  class="wp">l’article Wikipedia</a>)
* browser : le navigateur (Internet) installé sur la MACHINE
* PicoLisp : la version officielle du langage hôte, PicoLisp
* Ersatz : implémentation en Java de PicoLisp
* EmuLisp : implémentation en JavaScript de PicoLisp
* `pil`, `pil-j`, `pil-rjs` et `pil-njs` : les interpréteurs des
  implémentations de PicoLisp
* `microalg.l` : le fichier définissant le langage MicroAlg
* `malg`, `malg-j`, `malg-rjs` et `malg-njs` : les interpréteurs de MicroAlg,
  correspondants aux implémentations de PicoLisp
* « depuis éditeur » concerne par exemple [SciTE](doc.html#scite)
* web IDE : interface permettant de manipuler MicroAlg depuis un navigateur

### Composants

Cette section explique les relations entre les différents composants de
MicroAlg et les composants sur lequels elle repose.

MicroAlg est un langage embarqué dans un langage de type
<a href="http://fr.wikipedia.org/wiki/Lisp" class="wp">Lisp</a>, nommé
<a href="http://picolisp.com/" class="offi">PicoLisp</a>.
Ce dernier est implémenté au moins avec trois langages, C+ASM, Java et
JavaScript.

* En C+ASM, c’est la version dite *officielle*
  d’[Alexander Burger](http://software-lab.de/).
* En Java, c’est l’implémentation nommée Ersatz et réalisée par le créateur de
  PicoLisp lui-même.
* En JavaScript, c’est l’implémentation nommée EmuLisp, réalisée par
  [Jon Kleiser](http://folk.uio.no/jkleiser/), dont je suis quasiment le seul
  utilisateur, et que je maintiens dans un
  [dépôt semi-officiel](https://github.com/grahack/emulisp).

Chaque implémentation posséde un programme principal, nommés respectivement
`pil`, `pil-j`, `pil-rjs` et `pil-njs`. Ces programmes ont deux missions :

* lancés sans argument, ils offrent un interpréteur interactif,
* lancés avec un nom de fichier en argument, ils interprètent ce fichier et
  passent en mode interactif, sauf si on les arrête avant.

Attention, `pil-j` n’est pas le nom officiel de l’exécutable d’Ersatz (c’est
`pil`). De plus, les versions officielles et semi-officielles d’EmuLisp n’ont
pas de `pil-Xjs`. `pil-rjs` et `pil-njs` n’existent (pour l’instant) que dans
MicroAlg.

### Interpréteurs

MicroAlg offre les programmes `malg`, `malg-j`, `malg-rjs` et `malg-njs`, qui
correspondent à leur `pil*` respectif. Ils ont les mêmes missions que leurs
homologues, à ces différences près :

* ils chargent `microalg.l`, le cœur du projet MicroAlg, où les commandes du
  langage sont définies ;
* ils n’acceptent qu’un argument : le fichier à exécuter ;
* ils n’entrent pas en mode interactif si un fichier est exécuté.

### Performances

Concernant les performances, la commande [`Millisecondes`](#sym-Millisecondes)
nous permet d’avoir les valeurs suivantes (sur la machine de développement du
patron, et sans moyenne sur plusieurs exécutions) :

    $ malg exemples/test_millisecondes.malg
    MicroAlg (PicoLisp)
    "39 millisecondes écoulées avant l’exécution de la première ligne."
    "Nous en sommes à 48 millisecondes après 500 Ajouter_a."
    "Soit 9 millisecondes pour 2ème la boucle."
    "Nous en sommes à 60 millisecondes après 500 autres Ajouter_a."
    "Soit 12 millisecondes pour 2ème la boucle."

    $ malg-njs exemples/test_millisecondes.malg
    MicroAlg (NodeJS + EmuLisp)
    "41 millisecondes écoulées avant l’exécution de la première ligne."
    "Nous en sommes à 181 millisecondes après 500 Ajouter_a."
    "Soit 140 millisecondes pour 2ème la boucle."
    "Nous en sommes à 289 millisecondes après 500 autres Ajouter_a."
    "Soit 108 millisecondes pour 2ème la boucle."

    $ malg-j exemples/test_millisecondes.malg
    MicroAlg (Ersatz)
    "211 millisecondes écoulées avant l’exécution de la première ligne."
    "Nous en sommes à 371 millisecondes après 500 Ajouter_a."
    "Soit 160 millisecondes pour 2ème la boucle."
    "Nous en sommes à 454 millisecondes après 500 autres Ajouter_a."
    "Soit 83 millisecondes pour 2ème la boucle."

    $ malg-rjs exemples/test_millisecondes.malg
    MicroAlg (RhinoJS + EmuLisp)
    "748 millisecondes écoulées avant l’exécution de la première ligne."
    "Nous en sommes à 1861 millisecondes après 500 Ajouter_a."
    "Soit 1113 millisecondes pour 2ème la boucle."
    "Nous en sommes à 2748 millisecondes après 500 autres Ajouter_a."
    "Soit 887 millisecondes pour 2ème la boucle."

En résumé :

* La version avec PicoLisp (`malg`) est de loin la plus rapide. Attention,
  elle ne peut travailler qu’avec les nombres entiers.
* Ensuite vient la version NodeJS+EmuLisp (`malg-njs`), qui démarre très vite
  et est sensiblement aussi rapide que la version Ersatz (`malg-j`).
* La version Ersatz (`malg-j`), qui est sans doute longue à démarrer à cause de
  Java (sans compter le démarrage de Java lui-même, qui n’est pas mesuré),
  peut rattraper la précédente version à moyen terme. Attention, elle ne peut
  travailler qu’avec les nombres entiers.
* Pour finir, la version Rhino+EmuLisp (`malg-rjs`) est bonne dernière. En
  effet, elle est à la fois pénalisée par Java et par l’interprétation avec
  JavaScript. Néanmoins, elle permet de travailler avec les nombres flottants
  avec le minimum d’installation de la part de l’utilisateur.

## Intégrations

MicroAlg s’intègre à d’autres systèmes. Pour l’instant, à part l’intégration
avec des éditeurs de texte, MicroAlg s’intègre uniquement avec Blockly,
mais il est prévu de travailler sur Mario, NetLogo, GeoGebra, GeoTortue…

### SciTE

Moins populaire que NotePad++, il est pourtant très souple et intéressant,
notamment pour mettre en place un nouveau langage.

#### Exécution

`F5` pour lancer le programme. Si c’est un nouveau fichier, il faudra tout
d’abord l’enregistrer, sans oublier l’extension `.malg`.

Par défaut, c’est `malg-rjs` qui est utilisé pour l’interprétation (voir la
section [architecture](#architecture)). Vous pouvez changer cette valeur en
allant dans le menu `View` puis `Parameters` (`SHIFT`+`F8` avec Windows).

La sortie apparaît dans le panneau de droite. Ce panneau sert aussi à interagir
avec le programme. Les valeurs demandées par le programme doivent y être tapées.

#### Panneau de sortie

* S’il est caché, il suffit de tirer la poignée à la souris.
* Si vous le trouvez encombré, vous pouvez supprimer son contenu comme si
  vous éditiez un fichier.
* Pour changer le focus de panneau, utiliser `CTRL`+`F6`.

**Bug connu** (si vous utilisez autre chose que Windows) : pas moyen de faire
en sorte que `(Demander)` attende l’utilisateur.

#### Abbréviations

Après avoir tapé les préfixes ci-dessous, un appui sur `Ctrl`+`B` vous
donnera la suite.

    (Af  ->  (Affecter_a |)
    (Afe ->  (Affecter_a | En_position )
    (A   ->  (Afficher |)
    (Aj  ->  (Ajouter_a |)
    (Co  ->  (Concatener |)
    (D   ->  (Definir |...
    (Dm  ->  (Demander)
    (E   ->  (Exemples_de |...
    # Pour Faire, deux lignes vides pour aider à penser au compteur.
    (F   ->  (Faire (|)...
    (I   ->  (Initialiser |)
    (Li  ->  (Liste |)
    (Lo  ->  (Longueur |)
    (Ni  ->  (Nieme |)
    (No  ->  (Nombre |)
    (Rd  ->  (Retirer_de |)
    (R   ->  (Retourner |)
    (S   ->  (Si (|) Alors...
    (Ss  ->  (Si (|) Alors () Sinon...
    # Pour Tant_que, deux lignes vides pour aider à penser au compteur.
    (Tq  ->  (Tant_que (|) Faire...

#### Problèmes connus

##### Pas de réaction

Si SciTE ne réagit pas, c’est peut-être parce que le précédent programme ne
s’est pas terminé correctement. Dans ce cas, plusieurs solutions :

* taper `(bye)` dans le panneau de droite, après le `?` ou le `:` ;
* cliquer sur `Tools` puis `Stop Executing` ;

puis réessayer. Attention, si vous utilisez la seconde méthode, un processus
`java.exe` peut continuer de tourner.

##### Unable to access jarfile

Merci d’éviter les espaces dans les différents chemins.

### Vim

Voici ce que vous pouvez mettre dans votre `.vimrc` si vous avez un fond
sombre. Si vous avez un fond clair, dîtes-moi ce qui fonctionne en envoyant
une copie d’écran.

    let g:lisp_rainbow = 1
    " Les opérateurs +-*/><= doivent rester blancs.
    hi def lispFunc   ctermfg=grey
    " Les textes en vert discret.
    hi def lispString ctermfg=darkgreen
    " Les parenthèses.
    hi def hlLevel0   ctermfg=darkred
    hi def hlLevel1   ctermfg=brown
    hi def hlLevel2   ctermfg=yellow
    hi def hlLevel3   ctermfg=green
    hi def hlLevel4   ctermfg=cyan
    hi def hlLevel5   ctermfg=blue
    hi def hlLevel6   ctermfg=darkmagenta

### Blockly

C’est un système de blocs à glisser et déposer, très souple, utilisé ici pour
rédiger des programmes de façon visuelle. Blockly ne peut s’utiliser qu’au
travers d’un navigateur, mais une connexion à Internet n’est pas obligatoire,
sauf pour l’installation (voir
[l’installation hors ligne pour Windows](https://github.com/Microalg/Microalg/blob/latest/INSTALL.md#hors-ligne)
ou [l’installation hors ligne pour les autres OS](https://github.com/Microalg/Microalg/blob/latest/INSTALL.md#hors-ligne-1)).

Voir [le site officiel](https://code.google.com/p/blockly/) et
[les démos](https://blockly-demo.appspot.com/static/apps/index.html) de Blockly.

#### Bloc Programme

Le bloc `Programme` ne fait rien en lui-même, mais seuls les blocs contenus
dans le bloc `Programme` seront pris en compte.

#### Nombres avec Blockly

Il faut taper un nombre dans un bloc nombre, sinon la valeur par défaut est 0.

Voir aussi [cette section](#nombre).

#### Textes avec Blockly

Il faut taper du texte dans un bloc de texte, sinon la valeur par défaut est
le texte vide `""`.

Voir aussi [cette section](#texte).

#### Opérations avec Blockly

Un même bloc permet d’obtenir différentes opérations. Pour choisir, cliquer sur
le menu déroulant, qui contient par défaut l’opération `+`.

Voir aussi les commandes 
[`+`](#sym-+), [`-`](#sym--), [`*`](#sym-*) et [`/`](#sym-/).

#### Comparaisons avec Blockly

Un même bloc permet d’obtenir différentes comparaisons. Pour choisir, cliquer sur
le menu déroulant, qui contient par défaut la comparaison `=`.

Voir aussi les commandes 
[`=`](#sym-=), [`=/`](#sym-=/), [`<`](#sym-<), [`>`](#sym-\>), [`<=`](#sym-<=)
et [`>=`](#sym->=).

## Sortie graphique

Pour sa sortie graphique, MicroAlg utilise
<a href="http://processing.org/" class="offi">Processing</a> et
<a href="http://processingjs.org/" class="offi">Processing.js</a>.

**Attention** : Pour l’instant, les programmes qui permettent une sortie
graphique ne peuvent pas être codés avec les blocs de Blockly.

### Mise en place de la sortie graphique

Pour l’installation de Processing sur votre plateforme, se reporter à
[cette page](https://github.com/Microalg/microalg/blob/latest/INSTALL.md).
Cette installation est nécessaire uniquement si vous utilisez MicroAlg avec
l’éditeur de texte SciTE.
Processing n’a pas besoin d’être installé si vous utilisez la galerie, et est
fourni dans l’archive si vous installez MicroAlg sur votre site.

Pour faire apparaître la fenêtre graphique :

* Sur la galerie, ajouter `"processing": true` à la configuration de votre
  échantillon (voir
  [cette page](http://galerie.microalg.info/microalg:config_echantillons)).
* Si vous utilisez MicroAlg avec l’éditeur de texte SciTE, lancer
    * `start_processing.bat` (Windows)
    * `start_processing.sh` (le reste)
* Si vous avez installé MicroAlg sur votre site, ajouter `processing: true` à
  l’appel de `inject_microalg_editor_in`.

### Utilisation des commandes graphiques

Vous pourriez avoir besoin d’avoir lu la section précédente :
[mise en place de Processing](#miseenplacedelasortiegraphique).

Avant de lire cette partie, assurez-vous d’avoir suivi le
[tutoriel graphique](tuto_graphique.html). Si vous avez besoin de lire la
documentation d’une commande précise, une liste des symboles prédéfinis est
disponible [ici](#listedessymbolesprdfinis).

**Attention** : les nombres flottants ne sont pas disponibles si vous
lancez les commandes avec SciTE configuré sur `malg` ou `malg-j`.

#### Généralités

La fenêtre graphique est un carré de 600 pixels de côté. L’origine des
coordonnées est dans le coin en bas à gauche.

Les commandes dédiées à la sortie graphique sont :

* formes géométriques
    * `Segment`
    * `Cercle` (et non `Disque` par soucis de cohérence avec les autres formes
      qui n’ont pas de nom pour les formes correspondantes pleines)
    * `Ellipse`
    * `Rectangle`
    * `Triangle`
* couleurs
    * `Contour`
    * `Remplissage`
* épaisseur
    * `Epaisseur` (sans accent sur le E)
* pour la tortue : `BC` `LC` `AV` `TD` `TG` (voir plus loin la
  [section tortue](#tortue))
* remise à zéro : `RAZ`

Elles sont chacunes documentées en profondeur dans la
[liste des symboles prédéfinis](#listedessymbolesprdfinis).

#### Couleurs

Les deux commandes qui permettent de gérer les couleurs sont `Contour` et
`Remplissage`, à qui on passe une couleur en paramètre. À partir de la ligne
où une de ces commandes est utilisée, toutes les formes seront dessinées avec
les couleurs choisies, jusqu’à un autre appel à `Contour` ou à `Remplissage`.

Une couleur est une liste de trois ou quatre entiers pouvant aller de 0 à 255.
Les trois premiers correspondent au système <a class="wp"
href="https://fr.wikipedia.org/wiki/Rouge_vert_bleu">système RVB</a>, et
le quatrième correspond au <a class="wp"
href="https://fr.wikipedia.org/wiki/Canal_alpha">canal alpha</a> (opacité). 
En résumé :

* le premier entier définit la quantité de rouge,
* le deuxième de vert,
* le troisième de bleu,
* le quatrième (facultatif) définit l’opacité de la couleur. Une opacité de
  zéro rendra la couleur totalement transparente.

Quelques exemples :

* Le vert pur s’écrira `(Liste 0 255 0)`.
* Le rouge pur semi-transparent s’écrira `(Liste 255 0 0 127)`

#### Épaisseur

L’épaisseur du tracé est gérée avec la commande `Epaisseur` (sans accent) à qui
on passe un entier en paramètre. C’est le nombre de pixel de la largeur des
traits.  À partir de la ligne cette commande est utilisée, toutes les formes
seront dessinées avec l’épaisseur choisie, jusqu’à un autre appel à `Epaisseur`.

## Tortue

L’affichage de la tortue est bien sûr graphique. Il est donc indispensable
d’avoir lu la section sur la [mise en place](#miseenplacedelasortiegraphique)
de la sortie graphique pour pouvoir utiliser la tortue.

Les commandes sont :

* `AV` pour avancer la tortue d’un certain nombre de pixels,
* `TD` et `TG` pour faire tourner la tortue sur elle-même (angle en degrés),
* `LC` et `BC` pour lever et baisser le crayon (la tortue ne laissera pas de
  trace si son crayon est levé),
* `RAZ` pour effacer le dessin et repositionner la tortue au centre et vers le
  haut.

Voir [cet exemple](tuto_graphique.html#tortue) dans le tutoriel graphique.

## Remerciements

<p id="testeurs">Relecteurs, testeurs et commentateurs :</p>

* [Charlotte Truchet](http://www.normalesup.org/~truchet/) pour ses précieux
  encouragements au tout début du projet.
* le groupe « **Utilisation des langages fonctionnels dans l’enseignement** » de
  [l’IREM de Nantes](http://www.irem.sciences.univ-nantes.fr/recherche/recherche2013-2014.html)
* Quentin S.
* Clément G. (8 ans au moment du test)
* [Nathann Cohen](https://www.lri.fr/membre.php?mb=1727)
* quelques collègues des listes **SIO Maths** et **IDE Gest**
* Samuel B.
* Jéjé
* David F.
* Luc V. et Piotr Allarski
* Les SIO1 de 2014-2015, cobayes grandeur nature, pour leur attitude
  (globalement) positive et leurs remarques (globalement) intéressantes.
* [Mael Cadorel](http://mcadorel.github.io) pour ses relectures attentives.
* Cédric Floquet
* [Thomas Moyse](https://github.com/t8g)
* Groupoid Kid, pour son brute-testing efficace et ses suggestions.
* [Colin de la Higuera](http://pagesperso.lina.univ-nantes.fr/~cdlh/), pour
  ses questions, ses encouragements et ses suggestions.
* [Annie Tartier](http://www.univ-nantes.fr/tartier-a), co-auteure de
  [Premiers Pas En Algorithmique](http://www.eyrolles.com/Accueil/Livre/informatique-premiers-pas-en-algorithmique-de-l-enonce-a-la-solution-exercices-corriges-niveau-a-9782340001251),
  pour ses tests en profondeur et ses suggestions pertinentes.
* [Jean-François Cauche](https://secouezlecours.wordpress.com/) pour ses
  encouragements, pour son accueil sur son blog et pour un de ses articles, qui
  m’a inspiré la commande `...`.
* Bérenger Recoules ([blog](https://berengerrecoules.wordpress.com/)
  [portfolio](http://b2renger.github.io/)) pour ses idées autour du travail
  avec Processing.
* Flo Carré pour ses remarques sur l’opacité dans le tuto graphique.
* Florence Cousin pour la découverte du bug où le rayon était en fait le diamètre.

<p id="modeles">Modèles et contre-modèles :</p>

* **Logo** &mdash; [article Wikipedia](http://fr.wikipedia.org/wiki/Logo_%28langage%29)
* **Scratch** &mdash; [article Wikipedia](http://fr.wikipedia.org/wiki/Scratch_%28langage%29)
* **Algobox**, par Pascal Brachet &mdash; [site officiel](http://www.xm1math.net/algobox/)
* **Java’s Cool** &mdash; [site officiel](http://javascool.gforge.inria.fr)
* **Blockly** &mdash; [page expliquant certaines décisions](https://code.google.com/p/blockly/wiki/Language)
* **PicoLisp**, par Alexander Burger &mdash; [site officiel](http://picolisp.com)
* **Scheme**, par Sussman et Steele &mdash;
  [article Wikipedia](http://fr.wikipedia.org/wiki/Scheme)
* **SICP**, par Abelson et Sussman &mdash;
  [article Wikipedia](http://en.wikipedia.org/wiki/Structure_and_Interpretation_of_Computer_Programs)
  (en anglais)
* **Arc**, par [Paul Graham](http://fr.wikipedia.org/wiki/Paul_Graham) &mdash;
  [site officiel](http://arclanguage.org/)

<p id="libs">Bases techniques et bibliothèques :</p>

* **PicoLisp** et **Ersatz**, par Alexander Burger &mdash; [site officiel](http://picolisp.com)
* **EmuLisp**, par Jon Kleiser &mdash; [GitHub](https://github.com/Grahack/EmuLisp)
* **jQuery**, par John Resig et la communauté &mdash; [site officiel](http://jquery.com/)
* **jQuery-term**, par Jakub T. Jankiewicz &mdash; [site officiel](http://terminal.jcubic.pl/)
* **parenedit**, &mdash; [basé sur cette réponse](http://stackoverflow.com/questions/14043727/auto-resizing-textarea-is-bumpy-highlighting-parentheses)
* **Blockly**, par Neil Fraser et la communauté &mdash; [site officiel](http://code.google.com/p/blockly/)
* **Scite**, par Neil Hodgson &mdash; [site officiel](http://www.scintilla.org/SciTE.html)

<p id="annexes">Pour les parties annexes du site :</p>

* [la galerie](http://galerie.microalg.info/) est réalisée avec
<a href="http://dokuwiki.org/" class="offi">Dokuwiki</a>
  (et utilise [ce plugin](https://github.com/Microalg/dokuwiki-plugin-microalg)),
* [les questions/réponses](http://qr.microalg.info/) avec
  <a href="http://askbot.org/" class="offi">AskBot</a>.

<p id"chlamy"><a href="http://fr.wikipedia.org/wiki/Chlamydomonas_reinhardtii"
class="wp">Cette algue</a> a, sans le savoir, contribué à donner à ce projet un
nom digne de ce nom.</p>

<br> <br> <br> <br> <br> <br> <br> <br> <br> <br>
<br> <br> <br> <br> <br> <br> <br> <br> <br> <br>
-->
        </script>
        <script>
        var scripts = document.getElementsByTagName('script');
        for (var i = 0; i < scripts.length; i++){
            var script = scripts[i];
            if (script.type != 'text/markdown') continue;
            var md = script.innerHTML.replace(/^\s<!--*/, '')
                .replace(/-->\s*$/, '');
            var markup = new Showdown.converter().makeHtml(md);
            document.write(markup);
        }
        </script>
        <script>
            var syms_as_list = EMULISP_CORE.eval("symboles").toString();
            var syms_as_strings = syms_as_list
                .slice(1, -1) // les parenthèses
                .split(' ')
                .map(cleanTransient);
            // TOC
            var toc = $('<div/>').appendTo($('#syms'));
            $.each(syms_as_strings, function(i, sym) {
                var span = $('<span/>').appendTo(toc);
                var code = $('<code/>').appendTo(span);
                $("<a/>").attr("href", "#sym-" + sym)
                    .attr("title", "Voir la doc de la commande " + sym)
                    .html(sym)
                    .appendTo(code);
                span.html((i==0? "" : " ") + span.html());
            });
            // Defs
            var defs = $('<div/>').appendTo($('#syms'));
            var dl = $('<dl/>').appendTo(defs);
            $.each(syms_as_strings, function(i, sym) {
                $('<a/>').attr("name", "sym-" + sym).appendTo(dl);
                var dt = $('<dt/>').appendTo(dl);
                var span = $('<span/>').appendTo(dt);
                $('<a/>').attr("href", "#sym-" + sym).html(sym).appendTo(span);
                var sym_doc = EMULISP_CORE.eval("(get '" + sym + " 'doc)").toString();
                sym_doc = cleanTransient(sym_doc);
                sym_doc = new Showdown.converter().makeHtml(sym_doc);
                $("<dd/>").html(sym_doc).appendTo(dl);
                // corps fonction $("<dd/>").html(lisp_sym.props.car.car.name).appendTo(dl);
            });
        </script>
        <script>
            $().showUp('.navbar', {
                upClass: 'navbar-show',
                downClass: 'navbar-hide'
            });
        </script>
    </body>
</html>
